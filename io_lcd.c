#include "io_lcd.h"
//#include<avr/io.h>
//#include<util/delay.h>
//#include<stdio.h>
//#include<stdbool.h>
//#include<inttypes.h>
volatile uint16_t LCD_W=240, LCD_H=320;
volatile uint16_t cursor_x, cursor_y;
static const unsigned char font[] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00,
	0x3E, 0x5B, 0x4F, 0x5B, 0x3E,
	0x3E, 0x6B, 0x4F, 0x6B, 0x3E,
	0x1C, 0x3E, 0x7C, 0x3E, 0x1C,
	0x18, 0x3C, 0x7E, 0x3C, 0x18,
	0x1C, 0x57, 0x7D, 0x57, 0x1C,
	0x1C, 0x5E, 0x7F, 0x5E, 0x1C,
	0x00, 0x18, 0x3C, 0x18, 0x00,
	0xFF, 0xE7, 0xC3, 0xE7, 0xFF,
	0x00, 0x18, 0x24, 0x18, 0x00,
	0xFF, 0xE7, 0xDB, 0xE7, 0xFF,
	0x30, 0x48, 0x3A, 0x06, 0x0E,
	0x26, 0x29, 0x79, 0x29, 0x26,
	0x40, 0x7F, 0x05, 0x05, 0x07,
	0x40, 0x7F, 0x05, 0x25, 0x3F,
	0x5A, 0x3C, 0xE7, 0x3C, 0x5A,
	0x7F, 0x3E, 0x1C, 0x1C, 0x08,
	0x08, 0x1C, 0x1C, 0x3E, 0x7F,
	0x14, 0x22, 0x7F, 0x22, 0x14,
	0x5F, 0x5F, 0x00, 0x5F, 0x5F,
	0x06, 0x09, 0x7F, 0x01, 0x7F,
	0x00, 0x66, 0x89, 0x95, 0x6A,
	0x60, 0x60, 0x60, 0x60, 0x60,
	0x94, 0xA2, 0xFF, 0xA2, 0x94,
	0x08, 0x04, 0x7E, 0x04, 0x08,
	0x10, 0x20, 0x7E, 0x20, 0x10,
	0x08, 0x08, 0x2A, 0x1C, 0x08,
	0x08, 0x1C, 0x2A, 0x08, 0x08,
	0x1E, 0x10, 0x10, 0x10, 0x10,
	0x0C, 0x1E, 0x0C, 0x1E, 0x0C,
	0x30, 0x38, 0x3E, 0x38, 0x30,
	0x06, 0x0E, 0x3E, 0x0E, 0x06,
	0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x5F, 0x00, 0x00,
	0x00, 0x07, 0x00, 0x07, 0x00,
	0x14, 0x7F, 0x14, 0x7F, 0x14,
	0x24, 0x2A, 0x7F, 0x2A, 0x12,
	0x23, 0x13, 0x08, 0x64, 0x62,
	0x36, 0x49, 0x56, 0x20, 0x50,
	0x00, 0x08, 0x07, 0x03, 0x00,
	0x00, 0x1C, 0x22, 0x41, 0x00,
	0x00, 0x41, 0x22, 0x1C, 0x00,
	0x2A, 0x1C, 0x7F, 0x1C, 0x2A,
	0x08, 0x08, 0x3E, 0x08, 0x08,
	0x00, 0x80, 0x70, 0x30, 0x00,
	0x08, 0x08, 0x08, 0x08, 0x08,
	0x00, 0x00, 0x60, 0x60, 0x00,
	0x20, 0x10, 0x08, 0x04, 0x02,
	0x3E, 0x51, 0x49, 0x45, 0x3E,
	0x00, 0x42, 0x7F, 0x40, 0x00,
	0x72, 0x49, 0x49, 0x49, 0x46,
	0x21, 0x41, 0x49, 0x4D, 0x33,
	0x18, 0x14, 0x12, 0x7F, 0x10,
	0x27, 0x45, 0x45, 0x45, 0x39,
	0x3C, 0x4A, 0x49, 0x49, 0x31,
	0x41, 0x21, 0x11, 0x09, 0x07,
	0x36, 0x49, 0x49, 0x49, 0x36,
	0x46, 0x49, 0x49, 0x29, 0x1E,
	0x00, 0x00, 0x14, 0x00, 0x00,
	0x00, 0x40, 0x34, 0x00, 0x00,
	0x00, 0x08, 0x14, 0x22, 0x41,
	0x14, 0x14, 0x14, 0x14, 0x14,
	0x00, 0x41, 0x22, 0x14, 0x08,
	0x02, 0x01, 0x59, 0x09, 0x06,
	0x3E, 0x41, 0x5D, 0x59, 0x4E,
	0x7C, 0x12, 0x11, 0x12, 0x7C,
	0x7F, 0x49, 0x49, 0x49, 0x36,
	0x3E, 0x41, 0x41, 0x41, 0x22,
	0x7F, 0x41, 0x41, 0x41, 0x3E,
	0x7F, 0x49, 0x49, 0x49, 0x41,
	0x7F, 0x09, 0x09, 0x09, 0x01,
	0x3E, 0x41, 0x41, 0x51, 0x73,
	0x7F, 0x08, 0x08, 0x08, 0x7F,
	0x00, 0x41, 0x7F, 0x41, 0x00,
	0x20, 0x40, 0x41, 0x3F, 0x01,
	0x7F, 0x08, 0x14, 0x22, 0x41,
	0x7F, 0x40, 0x40, 0x40, 0x40,
	0x7F, 0x02, 0x1C, 0x02, 0x7F,
	0x7F, 0x04, 0x08, 0x10, 0x7F,
	0x3E, 0x41, 0x41, 0x41, 0x3E,
	0x7F, 0x09, 0x09, 0x09, 0x06,
	0x3E, 0x41, 0x51, 0x21, 0x5E,
	0x7F, 0x09, 0x19, 0x29, 0x46,
	0x26, 0x49, 0x49, 0x49, 0x32,
	0x03, 0x01, 0x7F, 0x01, 0x03,
	0x3F, 0x40, 0x40, 0x40, 0x3F,
	0x1F, 0x20, 0x40, 0x20, 0x1F,
	0x3F, 0x40, 0x38, 0x40, 0x3F,
	0x63, 0x14, 0x08, 0x14, 0x63,
	0x03, 0x04, 0x78, 0x04, 0x03,
	0x61, 0x59, 0x49, 0x4D, 0x43,
	0x00, 0x7F, 0x41, 0x41, 0x41,
	0x02, 0x04, 0x08, 0x10, 0x20,
	0x00, 0x41, 0x41, 0x41, 0x7F,
	0x04, 0x02, 0x01, 0x02, 0x04,
	0x40, 0x40, 0x40, 0x40, 0x40,
	0x00, 0x03, 0x07, 0x08, 0x00,
	0x20, 0x54, 0x54, 0x78, 0x40,
	0x7F, 0x28, 0x44, 0x44, 0x38,
	0x38, 0x44, 0x44, 0x44, 0x28,
	0x38, 0x44, 0x44, 0x28, 0x7F,
	0x38, 0x54, 0x54, 0x54, 0x18,
	0x00, 0x08, 0x7E, 0x09, 0x02,
	0x18, 0xA4, 0xA4, 0x9C, 0x78,
	0x7F, 0x08, 0x04, 0x04, 0x78,
	0x00, 0x44, 0x7D, 0x40, 0x00,
	0x20, 0x40, 0x40, 0x3D, 0x00,
	0x7F, 0x10, 0x28, 0x44, 0x00,
	0x00, 0x41, 0x7F, 0x40, 0x00,
	0x7C, 0x04, 0x78, 0x04, 0x78,
	0x7C, 0x08, 0x04, 0x04, 0x78,
	0x38, 0x44, 0x44, 0x44, 0x38,
	0xFC, 0x18, 0x24, 0x24, 0x18,
	0x18, 0x24, 0x24, 0x18, 0xFC,
	0x7C, 0x08, 0x04, 0x04, 0x08,
	0x48, 0x54, 0x54, 0x54, 0x24,
	0x04, 0x04, 0x3F, 0x44, 0x24,
	0x3C, 0x40, 0x40, 0x20, 0x7C,
	0x1C, 0x20, 0x40, 0x20, 0x1C,
	0x3C, 0x40, 0x30, 0x40, 0x3C,
	0x44, 0x28, 0x10, 0x28, 0x44,
	0x4C, 0x90, 0x90, 0x90, 0x7C,
	0x44, 0x64, 0x54, 0x4C, 0x44,
	0x00, 0x08, 0x36, 0x41, 0x00,
	0x00, 0x00, 0x77, 0x00, 0x00,
	0x00, 0x41, 0x36, 0x08, 0x00,
	0x02, 0x01, 0x02, 0x04, 0x02,
	0x3C, 0x26, 0x23, 0x26, 0x3C,
	0x1E, 0xA1, 0xA1, 0x61, 0x12,
	0x3A, 0x40, 0x40, 0x20, 0x7A,
	0x38, 0x54, 0x54, 0x55, 0x59,
	0x21, 0x55, 0x55, 0x79, 0x41,
	0x22, 0x54, 0x54, 0x78, 0x42, // a-umlaut
	0x21, 0x55, 0x54, 0x78, 0x40,
	0x20, 0x54, 0x55, 0x79, 0x40,
	0x0C, 0x1E, 0x52, 0x72, 0x12,
	0x39, 0x55, 0x55, 0x55, 0x59,
	0x39, 0x54, 0x54, 0x54, 0x59,
	0x39, 0x55, 0x54, 0x54, 0x58,
	0x00, 0x00, 0x45, 0x7C, 0x41,
	0x00, 0x02, 0x45, 0x7D, 0x42,
	0x00, 0x01, 0x45, 0x7C, 0x40,
	0x7D, 0x12, 0x11, 0x12, 0x7D, // A-umlaut
	0xF0, 0x28, 0x25, 0x28, 0xF0,
	0x7C, 0x54, 0x55, 0x45, 0x00,
	0x20, 0x54, 0x54, 0x7C, 0x54,
	0x7C, 0x0A, 0x09, 0x7F, 0x49,
	0x32, 0x49, 0x49, 0x49, 0x32,
	0x3A, 0x44, 0x44, 0x44, 0x3A, // o-umlaut
	0x32, 0x4A, 0x48, 0x48, 0x30,
	0x3A, 0x41, 0x41, 0x21, 0x7A,
	0x3A, 0x42, 0x40, 0x20, 0x78,
	0x00, 0x9D, 0xA0, 0xA0, 0x7D,
	0x3D, 0x42, 0x42, 0x42, 0x3D, // O-umlaut
	0x3D, 0x40, 0x40, 0x40, 0x3D,
	0x3C, 0x24, 0xFF, 0x24, 0x24,
	0x48, 0x7E, 0x49, 0x43, 0x66,
	0x2B, 0x2F, 0xFC, 0x2F, 0x2B,
	0xFF, 0x09, 0x29, 0xF6, 0x20,
	0xC0, 0x88, 0x7E, 0x09, 0x03,
	0x20, 0x54, 0x54, 0x79, 0x41,
	0x00, 0x00, 0x44, 0x7D, 0x41,
	0x30, 0x48, 0x48, 0x4A, 0x32,
	0x38, 0x40, 0x40, 0x22, 0x7A,
	0x00, 0x7A, 0x0A, 0x0A, 0x72,
	0x7D, 0x0D, 0x19, 0x31, 0x7D,
	0x26, 0x29, 0x29, 0x2F, 0x28,
	0x26, 0x29, 0x29, 0x29, 0x26,
	0x30, 0x48, 0x4D, 0x40, 0x20,
	0x38, 0x08, 0x08, 0x08, 0x08,
	0x08, 0x08, 0x08, 0x08, 0x38,
	0x2F, 0x10, 0xC8, 0xAC, 0xBA,
	0x2F, 0x10, 0x28, 0x34, 0xFA,
	0x00, 0x00, 0x7B, 0x00, 0x00,
	0x08, 0x14, 0x2A, 0x14, 0x22,
	0x22, 0x14, 0x2A, 0x14, 0x08,
	0xAA, 0x00, 0x55, 0x00, 0xAA,
	0xAA, 0x55, 0xAA, 0x55, 0xAA,
	0x00, 0x00, 0x00, 0xFF, 0x00,
	0x10, 0x10, 0x10, 0xFF, 0x00,
	0x14, 0x14, 0x14, 0xFF, 0x00,
	0x10, 0x10, 0xFF, 0x00, 0xFF,
	0x10, 0x10, 0xF0, 0x10, 0xF0,
	0x14, 0x14, 0x14, 0xFC, 0x00,
	0x14, 0x14, 0xF7, 0x00, 0xFF,
	0x00, 0x00, 0xFF, 0x00, 0xFF,
	0x14, 0x14, 0xF4, 0x04, 0xFC,
	0x14, 0x14, 0x17, 0x10, 0x1F,
	0x10, 0x10, 0x1F, 0x10, 0x1F,
	0x14, 0x14, 0x14, 0x1F, 0x00,
	0x10, 0x10, 0x10, 0xF0, 0x00,
	0x00, 0x00, 0x00, 0x1F, 0x10,
	0x10, 0x10, 0x10, 0x1F, 0x10,
	0x10, 0x10, 0x10, 0xF0, 0x10,
	0x00, 0x00, 0x00, 0xFF, 0x10,
	0x10, 0x10, 0x10, 0x10, 0x10,
	0x10, 0x10, 0x10, 0xFF, 0x10,
	0x00, 0x00, 0x00, 0xFF, 0x14,
	0x00, 0x00, 0xFF, 0x00, 0xFF,
	0x00, 0x00, 0x1F, 0x10, 0x17,
	0x00, 0x00, 0xFC, 0x04, 0xF4,
	0x14, 0x14, 0x17, 0x10, 0x17,
	0x14, 0x14, 0xF4, 0x04, 0xF4,
	0x00, 0x00, 0xFF, 0x00, 0xF7,
	0x14, 0x14, 0x14, 0x14, 0x14,
	0x14, 0x14, 0xF7, 0x00, 0xF7,
	0x14, 0x14, 0x14, 0x17, 0x14,
	0x10, 0x10, 0x1F, 0x10, 0x1F,
	0x14, 0x14, 0x14, 0xF4, 0x14,
	0x10, 0x10, 0xF0, 0x10, 0xF0,
	0x00, 0x00, 0x1F, 0x10, 0x1F,
	0x00, 0x00, 0x00, 0x1F, 0x14,
	0x00, 0x00, 0x00, 0xFC, 0x14,
	0x00, 0x00, 0xF0, 0x10, 0xF0,
	0x10, 0x10, 0xFF, 0x10, 0xFF,
	0x14, 0x14, 0x14, 0xFF, 0x14,
	0x10, 0x10, 0x10, 0x1F, 0x00,
	0x00, 0x00, 0x00, 0xF0, 0x10,
	0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
	0xF0, 0xF0, 0xF0, 0xF0, 0xF0,
	0xFF, 0xFF, 0xFF, 0x00, 0x00,
	0x00, 0x00, 0x00, 0xFF, 0xFF,
	0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
	0x38, 0x44, 0x44, 0x38, 0x44,
	0xFC, 0x4A, 0x4A, 0x4A, 0x34, // sharp-s or beta
	0x7E, 0x02, 0x02, 0x06, 0x06,
	0x02, 0x7E, 0x02, 0x7E, 0x02,
	0x63, 0x55, 0x49, 0x41, 0x63,
	0x38, 0x44, 0x44, 0x3C, 0x04,
	0x40, 0x7E, 0x20, 0x1E, 0x20,
	0x06, 0x02, 0x7E, 0x02, 0x02,
	0x99, 0xA5, 0xE7, 0xA5, 0x99,
	0x1C, 0x2A, 0x49, 0x2A, 0x1C,
	0x4C, 0x72, 0x01, 0x72, 0x4C,
	0x30, 0x4A, 0x4D, 0x4D, 0x30,
	0x30, 0x48, 0x78, 0x48, 0x30,
	0xBC, 0x62, 0x5A, 0x46, 0x3D,
	0x3E, 0x49, 0x49, 0x49, 0x00,
	0x7E, 0x01, 0x01, 0x01, 0x7E,
	0x2A, 0x2A, 0x2A, 0x2A, 0x2A,
	0x44, 0x44, 0x5F, 0x44, 0x44,
	0x40, 0x51, 0x4A, 0x44, 0x40,
	0x40, 0x44, 0x4A, 0x51, 0x40,
	0x00, 0x00, 0xFF, 0x01, 0x03,
	0xE0, 0x80, 0xFF, 0x00, 0x00,
	0x08, 0x08, 0x6B, 0x6B, 0x08,
	0x36, 0x12, 0x36, 0x24, 0x36,
	0x06, 0x0F, 0x09, 0x0F, 0x06,
	0x00, 0x00, 0x18, 0x18, 0x00,
	0x00, 0x00, 0x10, 0x10, 0x00,
	0x30, 0x40, 0xFF, 0x01, 0x01,
	0x00, 0x1F, 0x01, 0x01, 0x1E,
	0x00, 0x19, 0x1D, 0x17, 0x12,
	0x00, 0x3C, 0x3C, 0x3C, 0x3C,
	0x00, 0x00, 0x00, 0x00, 0x00
};



void LCD_Setup(void)
{
	LCD_DDR=0xFF;
	SPCR=(1<<SPE)|(1<<MSTR);
	SPSR |=(1<<SPI2X);
	LCD_PORT |=(1<<rst);//rst to init
	_delay_ms(10);


}


void LCD_WriteCommand(uint8_t com)
{
	LCD_PORT &=~((1<<dc)|(1<<cs));
	SPDR=com;
	while(!(SPSR & (1<<SPIF)));
	LCD_PORT |=(1<<cs);
}


void LCD_WriteData8(uint8_t data)//data write in byte
{
	LCD_PORT |=(1<<dc);
	LCD_PORT &=~(1<<cs);
	SPDR=data;
	while(!(SPSR & (1<<SPIF)));
	LCD_PORT |=(1<<cs);
}

void LCD_WriteData16(uint16_t data)//split data write 
{
	LCD_WriteData8(data>>8);
	LCD_WriteData8(data);
}

void delay_ms(int t){

	for(int i=0;i<t;i++)
	for(int j=0;j<775;j++)
	{
		asm("nop");
	}
}
void LCD_init(void)
{
	LCD_Setup();

	//power control A, predefined as datasheet
	LCD_WriteCommand(0xCB);
	LCD_WriteData8(0x39);
	LCD_WriteData8(0x2C);
	LCD_WriteData8(0x00);
	LCD_WriteData8(0x34);
	LCD_WriteData8(0x02);

	//power control B
	LCD_WriteCommand(0xCF);
	LCD_WriteData8(0x00);
	LCD_WriteData8(0xC1);
	LCD_WriteData8(0x30);

	//driver timing control A
	LCD_WriteCommand(0xE8);
	LCD_WriteData8(0x85);
	LCD_WriteData8(0x00);
	LCD_WriteData8(0x78);

	//driver timing control B
	LCD_WriteCommand(0xEA);
	LCD_WriteData8(0x00);
	LCD_WriteData8(0x00);

	//power on sequence control
	LCD_WriteCommand(0xED);
	LCD_WriteData8(0x64);
	LCD_WriteData8(0x03);
	LCD_WriteData8(0x12);
	LCD_WriteData8(0x81);

	//pump ratio control
	LCD_WriteCommand(0xF7);
	LCD_WriteData8(0x20);

	//power control,VRH[5:0]
	LCD_WriteCommand(0xC0);
	LCD_WriteData8(0x23);

	//Power control,SAP[2:0];BT[3:0]
	LCD_WriteCommand(0xC1);
	LCD_WriteData8(0x10);

	//vcm control
	LCD_WriteCommand(0xC5);
	LCD_WriteData8(0x3E);
	LCD_WriteData8(0x28);

	//vcm control 2
	LCD_WriteCommand(0xC7);
	LCD_WriteData8(0x86);

	//memory access control
	LCD_WriteCommand(0x36);
	LCD_WriteData8(0x48);

	//pixel format
	LCD_WriteCommand(0x3A);
	LCD_WriteData8(0x55);

	//frameration control,normal mode full colours
	LCD_WriteCommand(0xB1);
	LCD_WriteData8(0x00);
	LCD_WriteData8(0x18);

	//display function control
	LCD_WriteCommand(0xB6);
	LCD_WriteData8(0x08);
	LCD_WriteData8(0x82);
	LCD_WriteData8(0x27);

	//3gamma function disable
	LCD_WriteCommand(0xF2);
	LCD_WriteData8(0x00);

	//gamma curve selected
	LCD_WriteCommand(0x26);
	LCD_WriteData8(0x01);

	//set positive gamma correction
	LCD_WriteCommand(0xE0);
	LCD_WriteData8(0x0F);
	LCD_WriteData8(0x31);
	LCD_WriteData8(0x2B);
	LCD_WriteData8(0x0C);
	LCD_WriteData8(0x0E);
	LCD_WriteData8(0x08);
	LCD_WriteData8(0x4E);
	LCD_WriteData8(0xF1);
	LCD_WriteData8(0x37);
	LCD_WriteData8(0x07);
	LCD_WriteData8(0x10);
	LCD_WriteData8(0x03);
	LCD_WriteData8(0x0E);
	LCD_WriteData8(0x09);
	LCD_WriteData8(0x00);

	//set negative gamma correction
	LCD_WriteCommand(0xE1);
	LCD_WriteData8(0x00);
	LCD_WriteData8(0x0E);
	LCD_WriteData8(0x14);
	LCD_WriteData8(0x03);
	LCD_WriteData8(0x11);
	LCD_WriteData8(0x07);
	LCD_WriteData8(0x31);
	LCD_WriteData8(0xC1);
	LCD_WriteData8(0x48);
	LCD_WriteData8(0x08);
	LCD_WriteData8(0x0F);
	LCD_WriteData8(0x0C);
	LCD_WriteData8(0x31);
	LCD_WriteData8(0x36);
	LCD_WriteData8(0x0F);

	//exit sleep
	LCD_WriteCommand(0x11);
	//display on
	LCD_WriteCommand(0x29);

	LCD_WriteCommand(0x36);
	LCD_WriteCommand(0x21);// inverse color and dir
	LCD_WriteData8(0x80|0x08);
	delay_ms(100);

}



void LCD_ClearScreen()
{
	
	LCD_WriteCommand(0x2A);
	LCD_WriteData16(0);
	LCD_WriteData16(LCD_W-1);
	LCD_WriteCommand(0x2B);
	LCD_WriteData16(0);
	LCD_WriteData8(LCD_H-1);
	LCD_WriteData8(LCD_H-1);

	LCD_WriteCommand(0x2C);//meory write

	for(int i=0;i<LCD_W;i++)
	{
		for(int j=0;j<LCD_H;j++)
		{
			LCD_WriteData8(WHITE>>8);
			LCD_WriteData8(WHITE);
		}
	}

}




void LCD_DrawPixel(uint16_t x3,uint16_t y3,uint16_t colour1)
{

	LCD_WriteCommand(0x2A);
	LCD_WriteData16(x3);
	LCD_WriteData16(x3+1);
	LCD_WriteCommand(0x2B);
	LCD_WriteData16(y3);
	LCD_WriteData8(y3+1);
	LCD_WriteData8(y3+1);

	LCD_WriteCommand(0x2C);

	LCD_WriteData16(colour1);
}




void LCD_DrawBlock(uint16_t x,uint16_t y,uint16_t w,uint16_t h,uint16_t colour)
{
	if((x >=LCD_W) || (y >=LCD_H)) return;
	if((x+w-1)>=LCD_W)
	w=LCD_W-x;
	if((y+h-1)>=LCD_H)
	h=LCD_H-y;

	LCD_WriteCommand(0x2A);
	LCD_WriteData16(x);
	LCD_WriteData16(x+w-1);
	LCD_WriteCommand(0x2B);
	LCD_WriteData16(y);
	LCD_WriteData8(y+h-1);
	LCD_WriteData8(y+h-1);
	
	LCD_WriteCommand(0x2C);
	
	for(y=h; y>0; y--)
	{
		for(x=w; x>0; x--)
		{
			LCD_WriteData16(colour);
		}
	}
}



void LCD_WriteString(unsigned char* c){
	for (int i =0;i<strlen(c);i++)
	{
		LCD_WriteChar(c[i]);
		cursor_x+=12;
	}
}
void LCD_WriteInt(int i){
	char str[10];
	itoa(i,str,10);
	LCD_WriteString(str);
}
void LCD_WriteChar(unsigned char c) 
{
	uint8_t size=2;
	int16_t x= cursor_x, y = cursor_y;

	for (int8_t i=0; i<6; i++ ) {
		uint8_t line;
		if (i == 5)
		line = 0x0;
		else
		line = pgm_read_byte(font+(c*5)+i);
		for (int8_t j = 0; j<8; j++) {
			if (line & 0x1) LCD_DrawBlock(x+(i*size), y+(j*size), size, size, BLACK);//draw color for new char
			else LCD_DrawBlock(x+i*size, y+j*size, size, size, WHITE); //erase old color
			line >>= 1;
		}
	}
}


void LCD_Cursor(uint16_t x,uint16_t y)
{
	cursor_x=x;
	cursor_y=y;
}



void LCD_DrawBoard(){
	
	for(int y =20;y<260;y+=20){
		for (int x =0;x<240;x++)
		{LCD_DrawPixel(x,y+4,BLACK);
		}
	}
	for(int y =20;y<240;y++){
		for (int x =0;x<240;x+=20)
		{LCD_DrawPixel(0+x,y+4,BLACK);
		}
	}
	LCD_Cursor(4,280);
	LCD_WriteString("Black Score ");
	LCD_Cursor(4,300);
	LCD_WriteString("White Score ");
	LCD_Cursor(76,4);
	LCD_WriteString("Turn");
	
}

void LCD_ShowPlayer(unsigned char i){
	LCD_Cursor(4,4);
	if(i==1) {
		LCD_WriteString("Black Turn");
	}
	else LCD_WriteString("White Turn");
}
void LCD_ShowBattery(unsigned short i){
	float voltage=i/9.7;
	
	LCD_Cursor(190,4);
	char str[10];
	itoa(i,str,10);
	LCD_WriteString(str);

}
void LCD_ShowScore(unsigned short b,unsigned short w){
	
	char str[10];
	itoa(b,str,10);
	LCD_Cursor(200,280);
	LCD_WriteString(str);
	LCD_Cursor(200,300);
	itoa(w,str,10);
	LCD_WriteString(str);

}
void LCD_GameCursor(unsigned char x,unsigned char y){
	//x,y are not pixel position, it's grid position 
	unsigned char cx=20*x;
	unsigned char cy=20*y;
	
	if(cx>240 || cy>240) return;
	//while(1){
		//if (dir==1)
		//{ LCD_Cursor(5+20*x-20,5+20*y);
		 //LCD_WriteChar(' ');
		//}
		LCD_Cursor(5+20*x,5+20*y);
		LCD_WriteChar('p');
		LCD_Cursor(5+20*x,5+20*y);
		delay_ms(50);
		LCD_WriteChar('q');
		LCD_Cursor(5+20*x,5+20*y);
		delay_ms(50);
	//}
	

}

void LCDGAMEINTI(){
	//delay_ms(100);
	LCD_init();
	LCD_ClearScreen();
	LCD_DrawBoard();
	LCD_ShowPlayer(1);//show black/white turn
	LCD_ShowBattery(100);//show battery percent
	LCD_ShowScore(0,0);
	//delay_ms(100);

}